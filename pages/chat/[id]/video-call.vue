<template>
  <section
      class="call-page video-call"
      :class="[isDialing ? 'is-dialing' : 'is-answered pb-28']"
  >
    <section class="background">
      <img src="/assets/images/call_background.png"/>
    </section>
    <section class="body">
      <template v-if="addCall">
        <AddUser @close="toggleAddCall" @select="selectUser" type="video"/>
      </template>
      <template v-if="isDialing">
        <section class="mt-14 flex items-center justify-center">
          <section class="relative">
            <img src="/assets/images/profile.png" class="w-40 h-40"/>
            <h2 class="mt-2 text-white text-center font-medium text-lg">
              Emma Watson
            </h2>
            <section class="absolute -left-16 -top-12 w-72 h-72">
              <svg
                  width="100%"
                  height="100%"
                  viewBox="0 0 220 220"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
              >
                <circle
                    cx="110"
                    cy="110"
                    r="107.5"
                    transform="matrix(1 0 0 -1 0 220)"
                    stroke="url(#paint0_linear_1_3940)"
                    stroke-width="5"
                    stroke-dasharray="1 1"
                />
                <defs>
                  <linearGradient
                      id="paint0_linear_1_3940"
                      x1="110"
                      y1="0"
                      x2="110"
                      y2="220"
                      gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#50CCE8"/>
                    <stop offset="1" stop-color="#50CCE8" stop-opacity="0"/>
                  </linearGradient>
                </defs>
              </svg>
            </section>
            <section class="absolute -left-10 rotate-180 -top-8 w-60 h-60">
              <svg
                  width="100%"
                  height="100%"
                  viewBox="0 0 220 220"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
              >
                <circle
                    cx="110"
                    cy="110"
                    r="107.5"
                    transform="matrix(1 0 0 -1 0 220)"
                    stroke="url(#paint0_linear_1_3940)"
                    stroke-width="5"
                    stroke-dasharray="1 1"
                />
                <defs>
                  <linearGradient
                      id="paint0_linear_1_3940"
                      x1="110"
                      y1="0"
                      x2="110"
                      y2="220"
                      gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#50CCE8"/>
                    <stop offset="1" stop-color="#50CCE8" stop-opacity="0"/>
                  </linearGradient>
                </defs>
              </svg>
            </section>
          </section>
        </section>
        <section class="mt-20 flex justify-center">
          <el-button
              text
              class="w-20 h-20 bg-success-500 rounded-full flex items-center justify-center grow-0 relative"
          >
            <svg
                width="30"
                height="21"
                viewBox="0 0 30 21"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
              <path
                  d="M28.4858 3.22339C28.0302 3.01829 27.5245 2.95157 27.0314 3.03154C26.5383 3.11151 26.0795 3.33462 25.7121 3.67316L22.4888 6.67166V4.49775C22.4888 3.30487 22.0149 2.16085 21.1714 1.31736C20.3279 0.473869 19.1839 0 17.991 0H4.49775C3.30487 0 2.16085 0.473869 1.31736 1.31736C0.473869 2.16085 0 3.30487 0 4.49775V16.4918C0 17.6846 0.473869 18.8287 1.31736 19.6721C2.16085 20.5156 3.30487 20.9895 4.49775 20.9895H17.991C19.1839 20.9895 20.3279 20.5156 21.1714 19.6721C22.0149 18.8287 22.4888 17.6846 22.4888 16.4918V14.3178L25.7271 17.3163C26.2039 17.7479 26.8232 17.9882 27.4663 17.991C27.8231 17.9902 28.1757 17.9135 28.5008 17.7661C28.9429 17.5872 29.3218 17.2806 29.5888 16.8854C29.8559 16.4901 29.999 16.0242 30 15.5472V5.44228C29.9978 4.96355 29.8525 4.49642 29.5826 4.10099C29.3128 3.70556 28.9308 3.39992 28.4858 3.22339Z"
                  fill="white"
              />
            </svg>
          </el-button>
        </section>
      </template>
      <template v-else>
        <section class="main-video" v-if="!addCall">
          <section class="flex items-center justify-between bg-white">
            <section class="flex grow-0 items-center gap-1">
              <svg
                  width="25"
                  height="17"
                  viewBox="0 0 25 17"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
              >
                <path
                    d="M23.0714 2.61071C22.7025 2.4446 22.2929 2.39056 21.8935 2.45533C21.4941 2.5201 21.1225 2.70081 20.825 2.975L18.2143 5.40357V3.64286C18.2143 2.67671 17.8305 1.75014 17.1473 1.06697C16.4642 0.3838 15.5376 0 14.5714 0H3.64286C2.67671 0 1.75014 0.3838 1.06697 1.06697C0.3838 1.75014 0 2.67671 0 3.64286V13.3571C0 14.3233 0.3838 15.2499 1.06697 15.933C1.75014 16.6162 2.67671 17 3.64286 17H14.5714C15.5376 17 16.4642 16.6162 17.1473 15.933C17.8305 15.2499 18.2143 14.3233 18.2143 13.3571V11.5964L20.8371 14.025C21.2233 14.3745 21.7249 14.5691 22.2457 14.5714C22.5348 14.5708 22.8203 14.5087 23.0836 14.3893C23.4417 14.2444 23.7485 13.996 23.9648 13.6759C24.1811 13.3558 24.2971 12.9785 24.2979 12.5921V4.40786C24.2961 4.02012 24.1784 3.64178 23.9598 3.32151C23.7412 3.00124 23.4318 2.75369 23.0714 2.61071Z"
                    fill="#3FE07C"
                />
              </svg>
              <p class="text-lg font-medium text-gray-700">
                Emma Watson, {{ Math.floor(timer / 60) }} : {{ timer % 60 }}
              </p>
            </section>
            <el-button class="btn" text @click="toggleAddCall">
              <section class="flex items-center gap-1">
                <p class="text-primary-300 font-normal text-base">
                  Add Friends
                </p>
                <svg
                    width="15"
                    height="15"
                    viewBox="0 0 15 15"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                  <g clip-path="url(#clip0_1_3652)">
                    <path
                        d="M1.875 0C1.37772 0 0.900806 0.197544 0.549175 0.549175C0.197544 0.900806 0 1.37772 0 1.875L0 13.125C0 13.6223 0.197544 14.0992 0.549175 14.4508C0.900806 14.8025 1.37772 15 1.875 15H13.125C13.6223 15 14.0992 14.8025 14.4508 14.4508C14.8025 14.0992 15 13.6223 15 13.125V1.875C15 1.37772 14.8025 0.900806 14.4508 0.549175C14.0992 0.197544 13.6223 0 13.125 0L1.875 0ZM7.96875 4.21875V7.03125H10.7812C10.9056 7.03125 11.0248 7.08064 11.1127 7.16854C11.2006 7.25645 11.25 7.37568 11.25 7.5C11.25 7.62432 11.2006 7.74355 11.1127 7.83146C11.0248 7.91936 10.9056 7.96875 10.7812 7.96875H7.96875V10.7812C7.96875 10.9056 7.91936 11.0248 7.83146 11.1127C7.74355 11.2006 7.62432 11.25 7.5 11.25C7.37568 11.25 7.25645 11.2006 7.16854 11.1127C7.08064 11.0248 7.03125 10.9056 7.03125 10.7812V7.96875H4.21875C4.09443 7.96875 3.9752 7.91936 3.88729 7.83146C3.79939 7.74355 3.75 7.62432 3.75 7.5C3.75 7.37568 3.79939 7.25645 3.88729 7.16854C3.9752 7.08064 4.09443 7.03125 4.21875 7.03125H7.03125V4.21875C7.03125 4.09443 7.08064 3.9752 7.16854 3.88729C7.25645 3.79939 7.37568 3.75 7.5 3.75C7.62432 3.75 7.74355 3.79939 7.83146 3.88729C7.91936 3.9752 7.96875 4.09443 7.96875 4.21875Z"
                        fill="#50CCE8"
                    />
                  </g>
                  <defs>
                    <clipPath id="clip0_1_3652">
                      <rect width="15" height="15" fill="white"/>
                    </clipPath>
                  </defs>
                </svg>
              </section>
            </el-button>
          </section>
          <section class="image">
            <video id="share-screen-main" :class="[isScreenShared ? '' : 'hidden']" autoplay></video>
              <img :src="mainPicture" :class="[isScreenShared ? 'hidden' : '']"/>
          </section>
        </section>
        <section class="mt-2 other-videos justify-center">
          <template>
            <section class="relative">
              <img
                  :src="userPicture"
                  class="w-44 rounded-lg h-[118px]"
                  @click="mainPicture = userPicture"
                  v-if="isCameraOn"
              />
              <img
                  :src="NoUser"
                  class="w-44 rounded-lg h-[118px]"
                  v-if="!isCameraOn"
              />

              <section
                  class="absolute left-0 bottom-1 w-full flex justify-center"
                  v-if="isCameraOn"
              >
                <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                      d="M0.943447 6.33096C0.776757 6.33096 0.616894 6.26547 0.499027 6.14889C0.381159 6.03232 0.314941 5.87421 0.314941 5.70936V0.73781C0.314941 0.572951 0.381159 0.414845 0.499027 0.298273C0.616894 0.181701 0.776757 0.116211 0.943447 0.116211H5.97149C6.13818 0.116211 6.29804 0.181701 6.41591 0.298273C6.53378 0.414845 6.6 0.572951 6.6 0.73781V5.70936C6.6 5.87421 6.53378 6.03232 6.41591 6.14889C6.29804 6.26547 6.13818 6.33096 5.97149 6.33096H0.943447ZM9.74252 6.33096C9.57583 6.33096 9.41597 6.26547 9.2981 6.14889C9.18024 6.03232 9.11402 5.87421 9.11402 5.70936V0.73781C9.11402 0.572951 9.18024 0.414845 9.2981 0.298273C9.41597 0.181701 9.57583 0.116211 9.74252 0.116211H14.7693C14.936 0.116211 15.0959 0.181701 15.2137 0.298273C15.3316 0.414845 15.3978 0.572951 15.3978 0.73781V5.70936C15.3978 5.87421 15.3316 6.03232 15.2137 6.14889C15.0959 6.26547 14.936 6.33096 14.7693 6.33096H9.74252ZM0.943447 15.0333C0.776757 15.0333 0.616894 14.9678 0.499027 14.8513C0.381159 14.7347 0.314941 14.5766 0.314941 14.4117V9.43895C0.314941 9.27409 0.381159 9.11598 0.499027 8.99941C0.616894 8.88284 0.776757 8.81735 0.943447 8.81735H5.97149C6.13818 8.81735 6.29804 8.88284 6.41591 8.99941C6.53378 9.11598 6.6 9.27409 6.6 9.43895V14.4117C6.6 14.5766 6.53378 14.7347 6.41591 14.8513C6.29804 14.9678 6.13818 15.0333 5.97149 15.0333H0.943447ZM9.74252 15.0333C9.57583 15.0333 9.41597 14.9678 9.2981 14.8513C9.18024 14.7347 9.11402 14.5766 9.11402 14.4117V9.43895C9.11402 9.27409 9.18024 9.11598 9.2981 8.99941C9.41597 8.88284 9.57583 8.81735 9.74252 8.81735H14.7693C14.936 8.81735 15.0959 8.88284 15.2137 8.99941C15.3316 9.11598 15.3978 9.27409 15.3978 9.43895V14.4117C15.3978 14.5766 15.3316 14.7347 15.2137 14.8513C15.0959 14.9678 14.936 15.0333 14.7693 15.0333H9.74252Z"
                      fill="white"
                  />
                </svg>
              </section>
            </section>
          </template>
          <template v-for="index in persons">
            <section>
              <img
                  :src="`/assets/images/avatars/avatar${index + 10}.png`"
                  class="w-44 rounded-lg h-[118px]"
                  @click="mainPicture = `/assets/images/avatars/avatar${index + 10}.png`"
              />
            </section>
          </template>
        </section>
        <section class="mt-3 px-4 flex justify-center">
          <el-button class="btn btn-primary text-white w-full" @click="shareScreen">
            Share screen
          </el-button>
        </section>
      </template>
    </section>
    <section class="actions">
      <el-button class="btn" text @click="toggleCamera"
                 :class="[actionButtonsStatus.camera ? 'text-white' : 'bg-white text-gray-700']">
        <svg
            width="25"
            height="21"
            viewBox="0 0 25 21"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
          <path
              d="M2.28015 1.18029C2.21149 1.11891 2.12869 1.06967 2.03669 1.03553C1.94469 1.00138 1.84538 0.983023 1.74468 0.981543C1.64397 0.980063 1.54394 0.995493 1.45056 1.02691C1.35717 1.05834 1.27233 1.1051 1.20112 1.16443C1.1299 1.22375 1.07375 1.29442 1.03603 1.37221C0.99831 1.45 0.979785 1.53332 0.981562 1.61721C0.983339 1.70109 1.00538 1.78382 1.04637 1.86045C1.08736 1.93709 1.14647 2.00606 1.22015 2.06325L3.52015 3.98079C2.80378 4.11849 2.1646 4.45439 1.70692 4.93366C1.24924 5.41293 1.0001 6.00728 1.00015 6.61969V15.366C1.00015 16.084 1.34256 16.7726 1.95206 17.2803C2.56155 17.788 3.3882 18.0732 4.25015 18.0732H13.7522C14.593 18.0733 15.4012 17.8019 16.0069 17.316C16.6126 16.8301 16.9686 16.1676 17.0002 15.4677V15.2086L23.7202 20.8063C23.8617 20.92 24.0512 20.9829 24.2478 20.9814C24.4445 20.9799 24.6325 20.9141 24.7715 20.7983C24.9105 20.6824 24.9893 20.5256 24.9909 20.3618C24.9925 20.198 24.9168 20.0403 24.7802 19.9225L2.28015 1.18029Z"
              fill="currentColor"
          />
          <path
              d="M7.68262 3.9126L17.0006 11.6744V6.51818C16.9691 5.81823 16.613 5.15572 16.0074 4.66984C15.4017 4.18396 14.5935 3.91254 13.7526 3.9126H7.68262Z"
              fill="currentColor"
          />
          <path
              d="M18.5 12.9239L23.165 16.8106C23.4656 16.778 23.7415 16.655 23.941 16.4648C24.1404 16.2746 24.2496 16.0303 24.248 15.7777V6.20006C24.248 5.27128 22.898 4.80731 22.112 5.46537L18.5 8.48744V12.9239Z"
              fill="currentColor"
          />
        </svg>
      </el-button>
      <el-button class="btn" @click="voiceAccess" text
                 :class="[actionButtonsStatus.voice ? 'text-white' : 'bg-white text-gray-700']">
        <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
          <path
              d="M17.25 12.75C17.2471 13.7676 16.9485 14.7625 16.3905 15.6135C15.8325 16.4646 15.0392 17.1351 14.1071 17.5435C13.175 17.9519 12.1443 18.0807 11.1404 17.9141C10.1365 17.7474 9.20267 17.2926 8.4525 16.605L9.5175 15.5475C10.0577 16.0247 10.7241 16.336 11.4367 16.4443C12.1493 16.5526 12.878 16.4532 13.5356 16.158C14.1932 15.8629 14.7518 15.3844 15.1446 14.78C15.5373 14.1756 15.7475 13.4708 15.75 12.75V9.315L22.5 2.565L21.4425 1.5L1.5 21.4425L2.5575 22.5L7.3875 17.67C8.44612 18.67 9.8024 19.2967 11.25 19.455V21H8.25V22.5H15.75V21H12.75V19.455C14.3995 19.2706 15.9233 18.4849 17.0301 17.248C18.1369 16.0111 18.7492 14.4098 18.75 12.75V10.5H17.25V12.75Z"
              fill="currentColor"
          />
          <path
              d="M6.75 12.99V10.5H5.25V12.75C5.25097 13.278 5.3139 13.8041 5.4375 14.3175L6.75 12.99Z"
              fill="currentColor"
          />
          <path
              d="M15.57 4.18489C15.2991 3.34005 14.7373 2.61864 13.9847 2.14888C13.232 1.67911 12.3372 1.49142 11.4592 1.61916C10.5813 1.7469 9.777 2.18179 9.18942 2.84655C8.60183 3.51131 8.26897 4.36287 8.25 5.24989V11.5049L15.57 4.18489Z"
              fill="currentColor"
          />
        </svg>
      </el-button>
      <section
          @click="$router.go(-1)"
          class="w-16 h-16 rounded-full flex items-center justify-center grow-0 bg-error-700"
      >
        <svg
            width="33"
            height="14"
            viewBox="0 0 33 14"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
          <path
              d="M32.1147 9.10943L31.7985 10.7742C31.5005 12.3361 30.0431 13.3834 28.3912 13.226L25.1028 12.9078C23.6711 12.7692 22.4493 11.753 22.0848 10.393L21.0692 6.60961C19.5675 5.9928 17.9124 5.71248 16.105 5.76603C14.3638 5.80391 12.648 6.19081 11.059 6.9038L10.4336 10.4469C10.1946 11.7901 9.08644 12.7913 7.68429 12.9316L4.41585 13.2624C2.78402 13.4265 1.21994 12.3901 0.755845 10.8362L0.258585 9.17035C-0.236261 7.51268 0.204152 5.76686 1.41618 4.58991C4.27674 1.80897 9.04608 0.413593 15.7249 0.402455C22.4139 0.391653 27.335 1.77679 30.4825 4.55633C31.8072 5.72566 32.4291 7.45739 32.1147 9.10943Z"
              fill="white"
          />
        </svg>
      </section>
      <el-button class="btn" text>
        <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
          <path
              d="M15 4.24994V19.7459C15 20.8239 13.726 21.3959 12.92 20.6799L8.428 16.6859C8.29086 16.5638 8.11366 16.4962 7.93 16.4959H4.25C3.65344 16.4959 3.08129 16.259 2.65936 15.8373C2.23744 15.4155 2.00027 14.8435 2 14.2469V9.74994C2 9.15321 2.23705 8.58091 2.65901 8.15895C3.08097 7.737 3.65326 7.49994 4.25 7.49994H7.93C8.11366 7.49972 8.29086 7.43212 8.428 7.30994L12.919 3.31694C13.726 2.59894 15 3.16994 15 4.24994ZM18.992 5.89694C19.0712 5.83837 19.1611 5.79597 19.2567 5.77216C19.3523 5.74835 19.4516 5.7436 19.549 5.75818C19.6464 5.77276 19.74 5.80638 19.8244 5.85713C19.9088 5.90788 19.9824 5.97476 20.041 6.05394C21.3162 7.77384 22.0031 9.85889 22 11.9999C22.0028 14.1411 21.3155 16.2261 20.04 17.9459C19.9192 18.0987 19.7437 18.1984 19.5506 18.2241C19.3576 18.2497 19.1621 18.1993 19.0056 18.0834C18.849 17.9676 18.7437 17.7953 18.7119 17.6032C18.6801 17.4111 18.7242 17.2141 18.835 17.0539C19.9192 15.5923 20.5031 13.8199 20.5 11.9999C20.5031 10.18 19.9192 8.40764 18.835 6.94594C18.7764 6.86676 18.734 6.77681 18.7102 6.68124C18.6864 6.58566 18.6817 6.48634 18.6962 6.38893C18.7108 6.29152 18.7444 6.19793 18.7952 6.11352C18.8459 6.02911 18.9128 5.95551 18.992 5.89694ZM17.143 8.36994C17.2297 8.32301 17.3247 8.29362 17.4227 8.28345C17.5208 8.27328 17.6198 8.28253 17.7143 8.31067C17.8087 8.33881 17.8967 8.38529 17.9732 8.44745C18.0497 8.50961 18.1132 8.58624 18.16 8.67295C18.696 9.66294 19 10.7979 19 12.0009C19.0017 13.1629 18.7129 14.3069 18.16 15.3289C18.1131 15.4156 18.0496 15.4922 17.9731 15.5543C17.8967 15.6165 17.8087 15.6629 17.7143 15.6911C17.6198 15.7192 17.5208 15.7285 17.4227 15.7183C17.3247 15.7082 17.2297 15.6788 17.143 15.6319C17.0563 15.5851 16.9797 15.5216 16.9176 15.4451C16.8555 15.3686 16.809 15.2806 16.7809 15.1862C16.7527 15.0918 16.7435 14.9927 16.7536 14.8947C16.7638 14.7967 16.7931 14.7016 16.84 14.6149C17.26 13.8379 17.5 12.9489 17.5 12.0009C17.5 11.0529 17.26 10.1639 16.84 9.38694C16.7931 9.30028 16.7637 9.20522 16.7535 9.10719C16.7433 9.00917 16.7526 8.9101 16.7807 8.81565C16.8089 8.7212 16.8553 8.63322 16.9175 8.55674C16.9797 8.48027 17.0563 8.41679 17.143 8.36994Z"
              fill="white"
          />
        </svg>
      </el-button>
      <el-button class="btn" text>
        <svg
            width="14"
            height="23"
            viewBox="0 0 14 23"
            fill="none"
            @click="switchCamera"
            xmlns="http://www.w3.org/2000/svg"
        >
          <path
              d="M13.9316 17.5426C13.8659 17.3828 13.7544 17.246 13.6112 17.1494C13.4679 17.0528 13.2993 17.0009 13.1265 17H0.875099C0.643009 17 0.420424 17.0922 0.256311 17.2563C0.0921981 17.4204 0 17.643 0 17.8751C0 18.1072 0.0921981 18.3298 0.256311 18.4939C0.420424 18.658 0.643009 18.7502 0.875099 18.7502H11.0175L9.00477 20.7542C8.92275 20.8355 8.85765 20.9323 8.81322 21.039C8.76879 21.1456 8.74592 21.26 8.74592 21.3755C8.74592 21.491 8.76879 21.6054 8.81322 21.712C8.85765 21.8187 8.92275 21.9155 9.00477 21.9968C9.08612 22.0788 9.18291 22.1439 9.28955 22.1884C9.39619 22.2328 9.51057 22.2557 9.62609 22.2557C9.74162 22.2557 9.856 22.2328 9.96263 22.1884C10.0693 22.1439 10.1661 22.0788 10.2474 21.9968L13.7478 18.4964C13.8692 18.3734 13.9515 18.2171 13.9842 18.0473C14.0169 17.8776 13.9986 17.7019 13.9316 17.5426Z"
              fill="white"
          />
          <path
              d="M14 4.37908C14 4.14699 13.9078 3.9244 13.7437 3.76029C13.5796 3.59618 13.357 3.50398 13.1249 3.50398H2.9825L4.99523 1.5C5.16001 1.33522 5.25259 1.11172 5.25259 0.87868C5.25259 0.64564 5.16001 0.422144 4.99523 0.257359C4.83044 0.092575 4.60695 1.73629e-09 4.37391 0C4.14087 -1.73629e-09 3.91737 0.092575 3.75259 0.257359L0.252192 3.75776C0.130765 3.88082 0.0485089 4.03709 0.0158029 4.20685C-0.0169032 4.37661 0.00140619 4.55225 0.0684208 4.71161C0.134071 4.87142 0.245557 5.00823 0.388828 5.10478C0.5321 5.20133 0.700745 5.25331 0.873512 5.25418H13.1249C13.357 5.25418 13.5796 5.16198 13.7437 4.99787C13.9078 4.83375 14 4.61117 14 4.37908Z"
              fill="white"
          />
          <path
              d="M9.18749 11.594C9.18749 12.1646 8.95702 12.7119 8.54679 13.1154C8.13655 13.5189 7.58015 13.7456 6.99999 13.7456C6.41983 13.7456 5.86344 13.5189 5.4532 13.1154C5.04297 12.7119 4.8125 12.1646 4.8125 11.594C4.8125 11.0233 5.04297 10.4761 5.4532 10.0726C5.86344 9.66907 6.41983 9.44238 6.99999 9.44238C7.58015 9.44238 8.13655 9.66907 8.54679 10.0726C8.95702 10.4761 9.18749 11.0233 9.18749 11.594Z"
              fill="white"
          />
          <path
              d="M1.75 7.72127C1.28587 7.72127 0.840752 7.90262 0.512563 8.22542C0.184374 8.54823 0 8.98604 0 9.44255L0 14.6064C0 15.0629 0.184374 15.5007 0.512563 15.8235C0.840752 16.1463 1.28587 16.3276 1.75 16.3276H12.25C12.7141 16.3276 13.1592 16.1463 13.4874 15.8235C13.8156 15.5007 14 15.0629 14 14.6064V9.44255C14 8.98604 13.8156 8.54823 13.4874 8.22542C13.1592 7.90262 12.7141 7.72127 12.25 7.72127H11.2245C10.7604 7.72118 10.3154 7.53977 9.98725 7.21694L9.26275 6.50433C8.93464 6.18151 8.48959 6.0001 8.0255 6H5.9745C5.51041 6.0001 5.06536 6.18151 4.73725 6.50433L4.01275 7.21694C3.68464 7.53977 3.23959 7.72118 2.7755 7.72127H1.75ZM2.1875 9.44255C2.07147 9.44255 1.96019 9.39721 1.87814 9.31651C1.79609 9.23581 1.75 9.12636 1.75 9.01223C1.75 8.8981 1.79609 8.78865 1.87814 8.70795C1.96019 8.62725 2.07147 8.58191 2.1875 8.58191C2.30353 8.58191 2.41481 8.62725 2.49686 8.70795C2.57891 8.78865 2.625 8.8981 2.625 9.01223C2.625 9.12636 2.57891 9.23581 2.49686 9.31651C2.41481 9.39721 2.30353 9.44255 2.1875 9.44255ZM10.0625 11.5941C10.0625 12.393 9.73984 13.1592 9.16551 13.7241C8.59118 14.289 7.81223 14.6064 7 14.6064C6.18777 14.6064 5.40882 14.289 4.83449 13.7241C4.26016 13.1592 3.9375 12.393 3.9375 11.5941C3.9375 10.7952 4.26016 10.0291 4.83449 9.46417C5.40882 8.89927 6.18777 8.58191 7 8.58191C7.81223 8.58191 8.59118 8.89927 9.16551 9.46417C9.73984 10.0291 10.0625 10.7952 10.0625 11.5941Z"
              fill="white"
          />
          <path
              d="M1.75 7.72127C1.28587 7.72127 0.840752 7.90262 0.512563 8.22542C0.184374 8.54823 0 8.98604 0 9.44255L0 14.6064C0 15.0629 0.184374 15.5007 0.512563 15.8235C0.840752 16.1463 1.28587 16.3276 1.75 16.3276H12.25C12.7141 16.3276 13.1592 16.1463 13.4874 15.8235C13.8156 15.5007 14 15.0629 14 14.6064V9.44255C14 8.98604 13.8156 8.54823 13.4874 8.22542C13.1592 7.90262 12.7141 7.72127 12.25 7.72127H11.2245C10.7604 7.72118 10.3154 7.53977 9.98725 7.21694L9.26275 6.50433C8.93464 6.18151 8.48959 6.0001 8.0255 6H5.9745C5.51041 6.0001 5.06536 6.18151 4.73725 6.50433L4.01275 7.21694C3.68464 7.53977 3.23959 7.72118 2.7755 7.72127H1.75ZM2.1875 9.44255C2.07147 9.44255 1.96019 9.39721 1.87814 9.31651C1.79609 9.23581 1.75 9.12636 1.75 9.01223C1.75 8.8981 1.79609 8.78865 1.87814 8.70795C1.96019 8.62725 2.07147 8.58191 2.1875 8.58191C2.30353 8.58191 2.41481 8.62725 2.49686 8.70795C2.57891 8.78865 2.625 8.8981 2.625 9.01223C2.625 9.12636 2.57891 9.23581 2.49686 9.31651C2.41481 9.39721 2.30353 9.44255 2.1875 9.44255ZM10.0625 11.5941C10.0625 12.393 9.73984 13.1592 9.16551 13.7241C8.59118 14.289 7.81223 14.6064 7 14.6064C6.18777 14.6064 5.40882 14.289 4.83449 13.7241C4.26016 13.1592 3.9375 12.393 3.9375 11.5941C3.9375 10.7952 4.26016 10.0291 4.83449 9.46417C5.40882 8.89927 6.18777 8.58191 7 8.58191C7.81223 8.58191 8.59118 8.89927 9.16551 9.46417C9.73984 10.0291 10.0625 10.7952 10.0625 11.5941Z"
              fill="white"
          />
        </svg>
      </el-button>
    </section>
  </section>
</template>

<script setup>
import AddUser from "@/components/Chat/VoiceCall/AddUser";
import NoUser from "/assets/images/no-user.png";

definePageMeta({
  layout: "full",
});

const isDialing = ref(true);
const persons = ref(1);
const mainPicture = ref('/assets/images/avatars/avatar10.png')
const userPicture = ref(('/assets/images/avatars/avatar10.png'))
const timer = ref(0);
const interval = ref("");
const addCall = ref(false);
const isCameraOn = ref(true);
const isScreenShared = ref(false)
const actionButtonsStatus = reactive({
  camera: true,
  voice: true,
})

// methods
const toggleAddCall = () => {
  addCall.value = !addCall.value
};
const toggleCamera = () => {
  isCameraOn.value = !isCameraOn.value;
}
const selectUser = () => {
  toggleAddCall();
  if (persons.value < 4)
    persons.value++;
};
const switchCamera = () => {
  if (userPicture.value.search('avatar10') > -1) {
    userPicture.value = '/assets/images/posts/post7.png'
  } else {
    userPicture.value = '/assets/images/avatars/avatar10.png'
  }
  if (mainPicture.value.search('avatar10') > -1 || mainPicture.value.search('post7') > -1) {
    mainPicture.value = userPicture.value
  }
}
const setmainPicture = (value) => {
  if (mainPicture.value.search(userPicture.value) > -1 && !value) {
    mainPicture.value = `/assets/images/no-user.png`
  } else if (mainPicture.value.search('no-user') > -1 && value) {
    mainPicture.value = userPicture.value
  }
}

const voiceAccess = () => {
  actionButtonsStatus.voice = !actionButtonsStatus.voice
}
const shareScreen = async () => {
  isScreenShared.value = true
  try {
    const displayMediaOptions = {
      video: {
        displaySurface: "window",
      },
      audio: false,
    };
    let videoElem = document.getElementById('share-screen-main')
    videoElem.srcObject = await navigator.mediaDevices.getDisplayMedia(
        displayMediaOptions
    );
    const videoTrack = videoElem.srcObject.getVideoTracks()[0];
    videoElem.srcObject.getVideoTracks()[0].onended = ()=> {
      isScreenShared.value = false
    }
  } catch (e) {
    console.log(e);
    isScreenShared.value = false
  }
}

// watcher
watch(isDialing, (value) => {
  if (value == false) {
    timer.value = 0;
    interval.value = setInterval(() => {
      timer.value++;
    }, 1000);
  } else {
    clearInterval(interval.value);
  }
});
watch(isCameraOn, (value) => {
  actionButtonsStatus.camera = value
  setmainPicture(value)
})
// hooks
onMounted(() => {
  setTimeout(() => {
    isDialing.value = false;
  }, 2000);
});
</script>

<style scoped>
</style>